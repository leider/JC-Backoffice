include ../../../../views/formComponents

mixin plakateRow(werbung, name, label, optionen)
  .row
    .col-2
      +singleselect('werbung[' + name + 'Num]', label, werbung[name + 'Num'](), optionen.plakatNum())
    .col-2
      +singleselect('werbung[' + name + 'Groesse]', 'Größe', werbung[name + 'Groesse'](), optionen.plakatGroesse())
    .col-3
      +singleselect('werbung[' + name + 'Von]', 'Aufsteller', werbung[name + 'Von'](), optionen.plakatVon())
    .col-2
      +number('werbung[' + name + 'KW]', 'KW', werbung[name + 'KW'](), null, 0, 53)
    .col-3
      +currency('werbung[' + name + 'EUR]', 'Betrag', werbung[name + 'EUR']())

mixin marketingUndPlakate(werbung, optionen)
  +legendMitBody('plakate', 'Werbung', 'werbungTotal', 'costs')
    +plakateRow(werbung, 'plakat1', 'Plakat', optionen)
    +plakateRow(werbung, 'plakat2', 'Plakat', optionen)
    .row
      .col-7
        +text('werbung[genehmigungenInfo]', 'Genehmigungen', werbung.genehmigungenInfo(), null, 'Wer, Was')
      .col-2
        +number('werbung[genehmigungenNum]', 'Anzahl', werbung.genehmigungenNum(), null, 0, 500)
      .col-3
        +currency('werbung[genehmigungenEUR]', 'Betrag', werbung.genehmigungenEUR())
    .row
      .col-2
        +singleselect('werbung[flyerNum]', 'Flyer', werbung.flyerNum(), optionen.flyerNum())
      .col-7
        +text('werbung[flyerInfo]', 'Info', werbung.flyerInfo(), null, 'Größe, Lieferant')
      .col-3
        +currency('werbung[flyerEUR]', 'Betrag', werbung.flyerEUR())
    .row
      .col-9
        +text('werbung[layoutingInfo]', 'Arbeitskosten', werbung.layoutingInfo(), null, 'Layouting, Sonstiges')
      .col-3
        +currency('werbung[layoutingEUR]', 'Betrag', werbung.layoutingEUR())

mixin marketingUndPlakateScripts
  script.
    $(document).ready(function () {
      function updatePlakateTotal() {
        var plakat1EUR = $('#werbung\\[plakat1EUR\\]');
        var plakat2EUR = $('#werbung\\[plakat2EUR\\]');
        var flyerEUR = $('#werbung\\[flyerEUR\\]');
        var layoutingEUR = $('#werbung\\[layoutingEUR\\]');
        var genehmigungenEUR = $('#werbung\\[genehmigungenEUR\\]');
        var summe = floatAmount(plakat1EUR)
          + floatAmount(plakat2EUR)
          + floatAmount(flyerEUR)
          + floatAmount(layoutingEUR)
          + floatAmount(genehmigungenEUR);

        setEuro($('#werbungTotal'), summe);
      }

      $('#werbung\\[plakat1EUR\\]').keyup(updatePlakateTotal);
      $('#werbung\\[plakat2EUR\\]').keyup(updatePlakateTotal);
      $('#werbung\\[flyerEUR\\]').keyup(updatePlakateTotal);
      $('#werbung\\[layoutingEUR\\]').keyup(updatePlakateTotal);
      $('#werbung\\[genehmigungenEUR\\]').keyup(updatePlakateTotal);
      updatePlakateTotal();
    });
