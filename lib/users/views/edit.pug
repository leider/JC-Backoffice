extends ../../../views/layout
include ../../../views/formComponents

mixin submitButtonsWithDelete()
  .btn-group.float-right
    a.btn.btn-light(href='javascript:history.back()', type='cancel') Zurück
    if accessrights.isSuperuser()
      a.btn.btn-danger(href='/users/' + user.id + '/delete') Löschen
    button.btn.btn-primary(type='submit') Speichern

mixin hiddenGroup(gruppo)
  if (user.gruppen || []).includes(gruppo)
    +hidden('gruppen', gruppo)

mixin hiddenRight(right)
  if (user.rechte || []).includes(right)
    +hidden('rechte', right)

mixin groupCheckbox(label, gruppo)
  +checkbox('gruppen', label, !!(user.gruppen || []).includes(gruppo), gruppo)

block title
  | Users

block content
  -var shirtsizes = ['', 'S', 'M', 'L', 'XL', 'XXL', 'XXXL', 'No Shirt', 'Ladies\' XS', 'Ladies\' S', 'Ladies\' M', 'Ladies\' L', 'Ladies\' XL', 'Ladies\' XXL' ]
  .col-12
    form#userform.needs-validation(action='/users/submit', method='post', novalidate)
      .page-header
        +submitButtonsWithDelete()
        h2 User "#{user.id}" bearbeiten
        +csrf
      +hidden('id', user.id)
      +textRequired('name', 'Voller Name', user.name)
      +email('email', 'E-Mail', user.email)
      +text('tel', 'Tel', user.tel)
      +singleselect('tshirt', 'T-Shirt', user.tshirt, shirtsizes)
      .row
        .col-md-6
          if accessrights.isSuperuser()
            +groupCheckbox('Superuser', 'superusers')
            +groupCheckbox('Booking Team', 'bookingTeam')
            +groupCheckbox('Orga Team', 'orgaTeam')
            +groupCheckbox('Abendkasse', 'abendkasse')
          else
            +hiddenGroup('superusers')
            +hiddenGroup('bookingTeam')
            +hiddenGroup('orgaTeam')
            +hiddenGroup('abendkasse')
        .col-md-6
          if accessrights.isSuperuser()
            +checkbox('rechte', 'Kassenfreigabe', !!(user.rechte || []).includes('kassenfreigabe'), 'kassenfreigabe')
          else
            +hiddenRight('kassenfreigabe')
      +submitButtonsWithDelete()
